# ğŸ“ Dijkstra ì•Œê³ ë¦¬ì¦˜ê³¼ Heap ê¸°ë°˜ ìµœë‹¨ê²½ë¡œ íƒìƒ‰

## 1ï¸âƒ£ ê°œìš”

- **ë‹¤ìµìŠ¤íŠ¸ë¼ ì•Œê³ ë¦¬ì¦˜**ì€ ê°€ì¤‘ì¹˜ ê·¸ë˜í”„ì—ì„œ ì¶œë°œì ìœ¼ë¡œë¶€í„° ëª¨ë“  ëª©í‘œì§€ì ê¹Œì§€ì˜ ìµœë‹¨ ê²½ë¡œë¥¼ êµ¬í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ë‹¤.
- í˜„ëŒ€ ë¬¼ë¥˜ ì‹œìŠ¤í…œì—ì„œë„ ì°¨ëŸ‰ì˜ ë°°ì†¡ ê²½ë¡œ ìµœì í™”, ë‚´ë¹„ê²Œì´ì…˜, êµí†µ ë„¤íŠ¸ì›Œí¬ ë¶„ì„ ë“± ì—¬ëŸ¬ ë¶„ì•¼ì— ë„ë¦¬ í™œìš©ëœë‹¤.
- ë‹¤ìµìŠ¤íŠ¸ë¼ ì•Œê³ ë¦¬ì¦˜ì€ ìš°ì„ ìˆœìœ„ í(min-heap) ìë£Œêµ¬ì¡°ì™€ ê²°í•©í•˜ì—¬ êµ¬í˜„í•  ë•Œ ê° ë‹¨ê³„ì—ì„œ ë¯¸ë°©ë¬¸ ë…¸ë“œ ì¤‘ ìµœì†Œ ê±°ë¦¬ë¥¼ ë¹ ë¥´ê²Œ ì„ íƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ íš¨ìœ¨ì„±ì´ í¬ê²Œ í–¥ìƒëœë‹¤.

- ë¬¼ë¥˜ ë°°ì†¡ ê²½ë¡œ ìµœì í™”ì™€ ê°™ì´ ë³µì¡í•œ ë„ë¡œ ë„¤íŠ¸ì›Œí¬ì—ì„œ ìµœë‹¨ì‹œê°„ ê²½ë¡œë¥¼ ê³„ì‚°í•˜ëŠ” ë¬¸ì œì— ë‹¤ìµìŠ¤íŠ¸ë¼+í™ ê¸°ë²•ì„ ì ìš©í•˜ë©´, ì‹¤ì‹œê°„ìœ¼ë¡œ ê²½ë¡œë¥¼ íƒìƒ‰í•˜ê³  ìµœì ì˜ ë°°ì†¡ ê³„íšì„ ì„¸ìš¸ ìˆ˜ ìˆë‹¤.

## 2ï¸âƒ£ Dijkstra ì•Œê³ ë¦¬ì¦˜ ì†Œê°œ

- ë‹¤ìµìŠ¤íŠ¸ë¼ ì•Œê³ ë¦¬ì¦˜(Dijkstra Algorithm)ì€ ë‹¨ì¼ ì¶œë°œì ì—ì„œ ê·¸ë˜í”„ ë‚´ ë‹¤ë¥¸ ëª¨ë“  ì •ì ê¹Œì§€ì˜ ìµœë‹¨ ê²½ë¡œë¥¼ êµ¬í•˜ëŠ” ëŒ€í‘œì ì¸ ìµœë‹¨ê²½ë¡œ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤.
- ê·¸ë˜í”„ì˜ ê°„ì„ (weight)ì€ 0 ì´ìƒ, ì¦‰ ìŒìˆ˜ ê°€ì¤‘ì¹˜ê°€ ì—†ì–´ì•¼ ì •í™•í•˜ê²Œ ë™ì‘í•œë‹¤. ì•Œê³ ë¦¬ì¦˜ì˜ í•µì‹¬ ì›ë¦¬ëŠ” íƒìš•ë²•ìœ¼ë¡œ, ì•„ì§ ë°©ë¬¸í•˜ì§€ ì•Šì€ ë…¸ë“œ ì¤‘ í˜„ì¬ê¹Œì§€ ê±°ë¦¬ê°€ ê°€ì¥ ì§§ì€ ë…¸ë“œë¥¼ ë°˜ë³µì ìœ¼ë¡œ ì„ íƒí•˜ì—¬ ì¸ì ‘ ë…¸ë“œë“¤ì˜ ê±°ë¦¬ë¥¼ ê°±ì‹ (relax)í•˜ëŠ” ê²ƒì´ë‹¤.
- ì´ ê³¼ì •ì—ì„œ í•œ ë²ˆ ì„ íƒëœ ë…¸ë“œëŠ” ë‹¤ì‹œ ê°±ì‹ í•  í•„ìš”ê°€ ì—†ìœ¼ë¯€ë¡œ ìµœì¢…ì ìœ¼ë¡œ ê° ì •ì ê¹Œì§€ì˜ ìµœë‹¨ ê±°ë¦¬ê°€ í™•ì •ëœë‹¤.

### âœ… ì˜ˆì‹œë¡œ ì´í•´í•˜ê¸°

```python
graph = {
    'A' : {'B' : 3, 'C' : 6, 'D' : 7},
    'B' : {'A' : 3, 'C' : 1},
    'C' : {'A' : 6, 'B' : 1, 'D' : 1},
    'D' : {'A' : 7, 'C' : 1}
}
```

Aì—ì„œ ê° ë…¸ë“œê¹Œì§€ì˜ ìµœë‹¨ ê±°ë¦¬ë¥¼ êµ¬í•´ë³´ì.

ë¨¼ì € Aì—ì„œ ê° ë…¸ë“œê¹Œì§€ì˜ ê±°ë¦¬ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í‘œì´ë‹¤.

| A | B | C | D |
|:-:|:-:|:-:|:-:|
| 0 |inf|inf|inf|

Aë¶€í„° íƒìƒ‰í•˜ì—¬ ê±°ë¦¬ ìˆ˜ì •

| A | B | C | D |
|:-:|:-:|:-:|:-:|
| 0 | 3 | 6 | 7 |

ê·¸ ë‹¤ìŒ Bì—ì„œ íƒìƒ‰í•˜ì—¬ ê±°ë¦¬ ìˆ˜ì •

| A | B | C | D |
|:-:|:-:|:-:|:-:|
| 0 | 3 | 3 + 1 = 4 | 7 |

ê·¸ ë‹¤ìŒ Cì—ì„œ íƒìƒ‰í•˜ì—¬ ê±°ë¦¬ ìˆ˜ì •

| A | B | C | D |
|:-:|:-:|:-:|:-:|
| 0 | 3 | 4 | 4 + 1 = 5 |

ê·¸ ë‹¤ìŒ Dì—ì„œ íƒìƒ‰í•˜ì—¬ ê±°ë¦¬ ìˆ˜ì •

| A | B | C | D |
|:-:|:-:|:-:|:-:|
| 0 | 3 | 4 | 5 |

êµ¬ì²´ì ì¸ ì‘ë™ ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

1. ì¶œë°œ ë…¸ë“œë¥¼ ì„¤ì •
2. ì¶œë°œ ë…¸ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê° ë…¸ë“œì˜ ìµœì†Œ ë¹„ìš©ì„ ì €ì¥
3. ë°©ë¬¸í•˜ì§€ ì•Šì€ ë…¸ë“œ ì¤‘ì—ì„œ ê°€ì¥ ë¹„ìš©ì´ ì ì€ ë…¸ë“œë¥¼ ì„ íƒ
4. í•´ë‹¹ ë…¸ë“œë¥¼ ê±°ì³ì„œ íŠ¹ì •í•œ ë…¸ë“œë¡œ ê°€ëŠ” ê²½ìš°ë¥¼ ê³ ë ¤í•˜ì—¬ ìµœì†Œ ë¹„ìš©ì„ ê°±ì‹ 
5. ìœ„ ê³¼ì •ì—ì„œ 3 ~ 4ë²ˆì„ ë°˜ë³µ

### âœ… ì‹œê°„ë³µì¡ë„

Heap(ìš°ì„ ìˆœìœ„ í)ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë‹¤ìµìŠ¤íŠ¸ë¼ ì•Œê³ ë¦¬ì¦˜ì˜ **ì‹œê°„ë³µì¡ë„ëŠ” O(VÂ²)** ì´ë‹¤.

## 3ï¸âƒ£ Heap ìë£Œêµ¬ì¡°ì˜ íŠ¹ì§•ê³¼ í™œìš©

- Heap(í™)ì€ **ìš°ì„ ìˆœìœ„ í(priority queue)** ë¥¼ êµ¬í˜„í•  ë•Œ ìì£¼ ì‚¬ìš©í•˜ëŠ” ì™„ì „ ì´ì§„ íŠ¸ë¦¬(Complete Binary Tree) ê¸°ë°˜ì˜ ìë£Œêµ¬ì¡°ì´ë‹¤.

- Heapì€ í¬ê²Œ ë‘ ê°€ì§€ ì¢…ë¥˜ê°€ ìˆìœ¼ë©°, ì´ë“¤ì€ ë‹¤ìŒê³¼ ê°™ì€ íŠ¹ì§•ì„ ê°€ì§„ë‹¤:

| ì¢…ë¥˜       | íŠ¹ì§•                              | ë£¨íŠ¸ ë…¸ë“œì˜ ê°’ |
| -------- | ------------------------------- | -------- |
| Max Heap | ë¶€ëª¨ ë…¸ë“œ â‰¥ ìì‹ ë…¸ë“œ (ê°’ì´ í´ìˆ˜ë¡ ë†’ì€ ìš°ì„ ìˆœìœ„)  | í•­ìƒ ìµœëŒ“ê°’   |
| Min Heap | ë¶€ëª¨ ë…¸ë“œ â‰¤ ìì‹ ë…¸ë“œ (ê°’ì´ ì‘ì„ìˆ˜ë¡ ë†’ì€ ìš°ì„ ìˆœìœ„) | í•­ìƒ ìµœì†Ÿê°’   |

### âœ… ë°°ì—´ ì¸ë±ìŠ¤ ê¸°ë°˜ ê·œì¹™

#### ë…¸ë“œì˜ ìœ„ì¹˜ì™€ ê´€ê³„

- ì–´ë–¤ ë…¸ë“œê°€ **ì¸ë±ìŠ¤ `i`**ì— ìˆë‹¤ë©´:
  - ì™¼ìª½ ìì‹: ì¸ë±ìŠ¤ `2i + 1`
  - ì˜¤ë¥¸ìª½ ìì‹: ì¸ë±ìŠ¤ `2i + 2`
  - ë¶€ëª¨ ë…¸ë“œ: ì¸ë±ìŠ¤ `(i - 1) // 2`

### âœ… ì˜ˆì‹œë¡œ ì´í•´í•˜ê¸°

ë‹¤ìŒê³¼ ê°™ì€ **Min Heap**ì´ ìˆë‹¤ê³  ê°€ì •í•´ ë³´ì.

```
        4
       / \
     10   6
     / \
   20   15
```

ì´ íŠ¸ë¦¬ëŠ” ë°°ì—´ë¡œ ë‹¤ìŒê³¼ ê°™ì´ í‘œí˜„ëœë‹¤.

| ì¸ë±ìŠ¤ | ê°’  |
| --- | -- |
| 0   | 4  |
| 1   | 10 |
| 2   | 6  |
| 3   | 20 |
| 4   | 15 |

- Heapì—ì„œ **ì‚½ì…(insert)** ê³¼ ì‚­ì œ(delete, íŠ¹íˆ ë£¨íŠ¸ ë…¸ë“œ ì‚­ì œ) ì—°ì‚°ì˜ ì‹œê°„ë³µì¡ë„ëŠ” **O(log n)** ì´ë‹¤.
- ì´ ë³µì¡ë„ëŠ” **íŠ¸ë¦¬ì˜ ë†’ì´(log n)** ì— ë¹„ë¡€í•˜ëŠ” ì—°ì‚°ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

## 4ï¸âƒ£ Heap ê¸°ë°˜ Dijkstra ì•Œê³ ë¦¬ì¦˜ì˜ ë™ì‘ íë¦„

### âœ… ì˜ˆì‹œë¡œ ì´í•´í•˜ê¸°

```python
graph = {
    'A' = {'B' : 2, 'C' : 5, 'D' : 1}
    'B' = {'C' : 3, 'D' : 2}
    'C' = {'B' : 3}
    'D' = {'C' : 3, 'E' : 5}
    'E' = {'C' : 1, 'F' : 2}
    'F' = {'C' : 5}
}
```
 
Dijkstra ì•Œê³ ë¦¬ì¦˜ì— Min Heapì„ í™œìš©í•´ë³´ì.

| A | B | C | D | E | F |
|:-:|:-:|:-:|:-:|:-:|:-:|
| 0 |inf|inf|inf|inf|inf|

`Heap = [(0, 'A')]  # (ê±°ë¦¬, ë…¸ë“œ)`

| A | B | C | D | E | F |
|:-:|:-:|:-:|:-:|:-:|:-:|
| 0 | 2 | 5 | 1 |inf|inf|

`Heap = [(1, 'D'), (2, 'B'), (5, 'C')]`

| A | B | C | D | E | F |
|:-:|:-:|:-:|:-:|:-:|:-:|
| 0 | 2 | 5->4 | 1 | inf->2 | inf |

`Heap = [(2, 'B'), (1+1, 'E'), (1+3, 'C'), (5, 'C')]`

| A | B | C | D | E | F |
|:-:|:-:|:-:|:-:|:-:|:-:|
| 0 | 2 | 4 | 1 | 2 | inf |

`Heap = [(2, 'E'), (4, 'C'), (5, 'C')]`

| A | B | C | D | E | F |
|:-:|:-:|:-:|:-:|:-:|:-:|
| 0 | 2 | 4->3 | 1 | 2 | inf->4 |

`Heap = [(2+1, 'C'), (4, 'C'), (2+2, 'F'), (5, 'C')]`

Heapì— ë‚¨ì€ ë‚˜ë¨¸ì§€ ê°’ìœ¼ë¡œëŠ” ë” ì´ìƒì˜ ìµœë‹¨ê²½ë¡œ ì°¾ì„ ìˆ˜ ì—†ìŒ.

#### âœ… ê²°ê³¼

| A | B | C | D | E | F |
|:-:|:-:|:-:|:-:|:-:|:-:|
| 0 | 2 | 3 | 1 | 2 | 4 |

### âœ… ì‹œê°„ë³µì¡ë„

Heap(ìš°ì„ ìˆœìœ„ í)ì„ ì‚¬ìš©í•˜ëŠ” ë‹¤ìµìŠ¤íŠ¸ë¼ ì•Œê³ ë¦¬ì¦˜ì˜ **ì‹œê°„ë³µì¡ë„ëŠ” O((V + E) log V)** ì´ë‹¤.

## 5ï¸âƒ£ ì°¸ê³  ë¬¸ì œ : ë°±ì¤€ 1400ë²ˆ í™”ë¬¼ì°¨

### âœ… ë¬¸ì œ

í™”ë¬¼ì°¨ê°€ ì¶œë°œì§€ ì°½ê³ ì—ì„œ ì§ì„ ì‹£ê³  ë°°ì†¡ì§€ ì°½ê³ ê¹Œì§€ ì§ì„ ìš´ë°˜í•˜ë ¤ê³  í•œë‹¤. ì´ ë„ì‹œì˜ ë„ë¡œë§ì„ ë‚˜íƒ€ë‚¸ ì§€ë„ì˜ ì˜ˆëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```
#A##0##1#
.#..#..#.
.#..#..#.
.###2#.B.
```

ë„ë¡œë§ì—ì„œ ì°¨ë“¤ì€ ë™, ì„œ, ë‚¨, ë¶ì˜ ë°©í–¥ìœ¼ë¡œë§Œ ì´ë™í•  ìˆ˜ ìˆê³ , ì§€ë„ì˜ ê° ë¬¸ìëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì˜ë¯¸ë¥¼ ê°€ì§„ë‹¤.
- 'A'ëŠ” ì¶œë°œì§€ ì°½ê³ ë¥¼ ë‚˜íƒ€ë‚´ê³ , ì§€ë„ì—ì„œ ìœ ì¼í•˜ë‹¤.
- 'B'ëŠ” ë°°ì†¡ì§€ ì°½ê³ ë¥¼ ë‚˜íƒ€ë‚´ê³ , ì§€ë„ì—ì„œ ìœ ì¼í•˜ë‹¤.
- '.'ì€ ì°¨ê°€ ë“¤ì–´ê°ˆ ìˆ˜ ì—†ëŠ” ê³³ì„ ë‚˜íƒ€ë‚¸ë‹¤.
- '#'ì€ ê° ë„ë¡œ ì…€ì„ ë‚˜íƒ€ë‚¸ë‹¤. '#'ì€ ê¸°ê»í•´ì•¼ ë‘ ê°œì˜ ë‹¤ë¥¸ ë„ë¡œ ì…€, ë˜ëŠ” êµì°¨ë¡œ, ì°½ê³ ì™€ ì¸ì ‘í•˜ë‹¤.
- ìˆ«ì [0-9]ëŠ” ì‹ í˜¸ë“±ì— ì˜í•´ ì œì–´ë˜ëŠ” êµì°¨ë¡œë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. êµì°¨ë¡œëŠ” ì ì–´ë„ ì„¸ ê°œì˜ ë„ë¡œ ì…€ê³¼ ì¸ì ‘í•˜ë‹¤. êµì°¨ë¡œë“¤ì€ 0ë¶€í„° 9ê¹Œì§€ì˜ ë²ˆí˜¸ë¡œ í‘œì‹œëœë‹¤. ë§Œì¼ ë²ˆí˜¸ kë¥¼ ê°€ì§„ êµì°¨ë¡œê°€ ìˆìœ¼ë©´, ë°˜ë“œì‹œ 0ë¶€í„° kê¹Œì§€ ë²ˆí˜¸ë¥¼ ê°€ì§„ êµì°¨ë¡œê°€ ì¡´ì¬í•œë‹¤. êµì°¨ë¡œì˜ ì‹ í˜¸ë“±ì— ëŒ€í•œ ì„¤ëª…ì€ ì•„ë˜ì— ë‚˜ì˜¨ë‹¤.

ì°¨ëŸ‰ì˜ ì´ë™ì€ ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ë¶„ì„ëœë‹¤.

- í™”ë¬¼ì°¨ê°€ ì¸ì ‘í•œ ë„ë¡œ ì…€, ë˜ëŠ” êµì°¨ë¡œ, ì°½ê³ ë¡œ ì´ë™í•˜ëŠ” ë° ê±¸ë¦¬ëŠ” ì‹œê°„ì„ ë‹¨ìœ„ ì‹œê°„ì´ë¼ê³  ê°€ì •í•œë‹¤. ì°¨ëŸ‰ì´ ì–´ë–¤ ìœ„ì¹˜ì—ì„œ ë©ˆì¶° ì„œ ìˆëŠ” ì‹œê°„ë„ ë‹¨ìœ„ ì‹œê°„ìœ¼ë¡œ ì¸¡ì •ëœë‹¤.
- í™”ë¬¼ì°¨ê°€ ì§„ì…í•˜ë ¤ëŠ” ë°©í–¥ìœ¼ë¡œ íŒŒë€ë¶ˆì´ ì¼œì ¸ ìˆì„ ë•Œë§Œ êµì°¨ë¡œë¡œ ë“¤ì–´ê°ˆ ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ êµì°¨ë¡œì— ë“¤ì–´ê°„ ì°¨ëŸ‰ì€ ì–¸ì œë“ ì§€ ì„ì˜ì˜ ë°©í–¥ìœ¼ë¡œ ë‚˜ê°ˆ ìˆ˜ ìˆë‹¤.
- êµì°¨ë¡œì˜ ì‹ í˜¸ë“±ì€ ë™ì„œ ë°©í–¥ê³¼ ë‚¨ë¶ ë°©í–¥, ë‘ ê°œì˜ ì‹ í˜¸ê°€ ì£¼ê¸°ì ìœ¼ë¡œ ì¼œì§„ë‹¤. êµì°¨ë¡œì˜ ì‹ í˜¸ëŠ” ì´ˆê¸°ì— ë™ì„œ ë°©í–¥ ë˜ëŠ” ë‚¨ë¶ ë°©í–¥ì´ ë  ìˆ˜ ìˆë‹¤. êµì°¨ë¡œì˜ ì‹ í˜¸ ì£¼ê¸°ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’ "a b"ëŠ” ë™ì„œ ë°©í–¥ì˜ ì‹ í˜¸ê°€ a ì‹œê°„ ì¼œì§€ê³ , ë‚¨ë¶ ë°©í–¥ì˜ ì‹ í˜¸ê°€ b ì‹œê°„ ì¼œì§ì„ ì˜ë¯¸í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì´ˆê¸°ì— ë‚¨ë¶ ë°©í–¥ì˜ ì‹ í˜¸ê°€ ì¼œì§€ê³  ì£¼ê¸° ê°’ì´ "2 3"ì´ë©´, ì°¨ëŸ‰ì´ 1-3 ì‹œê°„ì— ë‚¨ë¶ ë°©í–¥ì˜ ì‹ í˜¸ê°€ ì¼œì§€ê³ , 4-5 ì‹œê°„ì€ ë™ì„œ ë°©í–¥, 6-8 ì‹œê°„ì€ ë‹¤ì‹œ ë‚¨ë¶ ë°©í–¥ì˜ ì‹ í˜¸ê°€ ì¼œì§„ë‹¤.

ì¶œë°œì§€ ì°½ê³ ì—ì„œ ë°°ì†¡ì§€ ì°½ê³ ê¹Œì§€ ìµœë‹¨ ê²½ë¡œë¥¼ êµ¬í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ì‹œì˜¤.

### âœ… ì…ë ¥

ì…ë ¥ì€ ì—¬ëŸ¬ ê°œì˜ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¡œ êµ¬ì„±ëœë‹¤. ê° í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì˜ ì²«ì§¸ ì¤„ì—ëŠ” ë‘ ê°œì˜ ì •ìˆ˜ mê³¼ nì´ ì£¼ì–´ì§„ë‹¤, ì—¬ê¸°ì„œ mì€ ì§€ë„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í–‰ë ¬ì˜ í–‰ì˜ í¬ê¸°ì´ê³  nì€ ì—´ì˜ í¬ê¸°ì´ë‹¤(2 â‰¤ m, n â‰¤ 20).

ê·¸ ë‹¤ìŒ mê°œì˜ ì¤„ì—ëŠ” ê° ì¤„ë§ˆë‹¤ nê°œì˜ ë¬¸ìê°€ ì£¼ì–´ì§„ë‹¤. ê° ë¬¸ìëŠ” ì§€ë„ë¥¼ êµ¬ì„±í•˜ëŠ” ë¬¸ìì¸ '#', '.', 'A', 'B', [0-9]ë¡œ êµ¬ì„±ëœë‹¤.

ê·¸ ë‹¤ìŒ ì¤„ë¶€í„°ëŠ” ê° êµì°¨ë¡œì— ëŒ€í•œ ì •ë³´ê°€ ì£¼ì–´ì§„ë‹¤. êµì°¨ë¡œ ë²ˆí˜¸ê°€ 0ì¸ ê²ƒë¶€í„° ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ í•œ ì¤„ì— í•˜ë‚˜ì”© ì£¼ì–´ì§„ë‹¤. ê° ì¤„ì—ëŠ” êµì°¨ë¡œ ë²ˆí˜¸ iì™€ '-' ë˜ëŠ” '|', ê·¸ ë‹¤ìŒìœ¼ë¡œ ë‘ ê°œì˜ ì •ìˆ˜ aiì™€ bi (1 â‰¤ ai, bi â‰¤ 20) ê°€ ë¹ˆì¹¸ì„ ì‚¬ì´ì— ë‘ê³  ì£¼ì–´ì§„ë‹¤, ì—¬ê¸°ì„œ '-'ëŠ” ì‹ í˜¸ë“±ì´ ì´ˆê¸°ì— ë™ì„œ ë°©í–¥ì˜ ì‹ í˜¸ê°€ ì¼œì§ì„ ë‚˜íƒ€ë‚´ê³ , '|'ëŠ” ë‚¨ë¶ ë°©í–¥ì˜ ì‹ í˜¸ê°€ ì¼œì§ì„ ë‚˜íƒ€ë‚¸ë‹¤. aiì™€ biëŠ” ê°ê° ë™ì„œ ë°©í–¥ ì‹ í˜¸ê°€ ì¼œ ìˆëŠ” ì‹œê°„ê³¼ ë‚¨ë¶ ë°©í–¥ ì‹ í˜¸ê°€ ì¼œ ìˆëŠ” ì‹œê°„ì„ ë‚˜íƒ€ë‚¸ë‹¤.

ê° í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‚¬ì´ì—ëŠ” ë¹ˆ ì¤„ í•˜ë‚˜ê°€ ë“¤ì–´ ìˆê³ , ë‘ ê°œì˜ 0ìœ¼ë¡œ ì‹œì‘ë˜ëŠ” í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ëŠ” ì…ë ¥ì˜ ëì„ ë‚˜íƒ€ë‚¸ë‹¤. í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ëŠ” 20ê°œë¥¼ ë„˜ì§€ ì•ŠëŠ”ë‹¤ê³  ê°€ì •í•´ë„ ëœë‹¤.

### âœ… ì¶œë ¥

ê° í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì— ëŒ€í•´, í•œ ì¤„ì— í•œ ê°œì˜ ì •ìˆ˜ë¥¼ ì¶œë ¥í•œë‹¤. ì´ ì •ìˆ˜ëŠ” ì¶œë°œì§€ ì°½ê³ ì—ì„œ ë°°ì†¡ì§€ ì°½ê³ ê¹Œì§€ ì°¨ëŸ‰ìœ¼ë¡œ ì´ë™í•˜ëŠ” ë° ê±¸ë¦¬ëŠ” ìµœì†Œ ì‹œê°„ì´ë‹¤. ë§Œì¼ ì°¨ëŸ‰ì´ ë°°ì†¡ì§€ ì°½ê³ ê¹Œì§€ ë„ë‹¬í•  ìˆ˜ ì—†ìœ¼ë©´ "impossible"ì„ ì¶œë ¥í•œë‹¤.

### âœ… ì˜ˆì œ ì…ë ¥

```
3 4
A##B
#..#
####

4 9
#A##0##1#
.#..#..#.
.#..#..#.
.###2#.B.
0 - 1 17
1 | 3 5
2 - 2 4

2 2
A.
.B

0 0 
```

### âœ… ì˜ˆì œ ì¶œë ¥

```
3
17
impossible
```

---

## 6ï¸âƒ£ ë¬¸ì œ í•´ê²° ë° ì•Œê³ ë¦¬ì¦˜ ë¶„ì„

```python
import heapq

EW, NS = 0, 1

def isValid(Type):
    """ë²½('.')ì´ ì•„ë‹Œ ëª¨ë“  ì…€ì€ ìœ íš¨í•¨ - ë²½ ê²€ì‚¬ í•¨ìˆ˜"""
    return Type != '.'

def entryTime(t, d, Type, ew, ns):
    """
    ì‹ í˜¸ë“±ì´ ìˆëŠ” êµì°¨ë¡œì— ì§„ì…í•˜ëŠ” ì‹œê°„ ê³„ì‚°
    
    Parameters:
    - t: í˜„ì¬ ì‹œê°„
    - d: ì§„ì… ë°©í–¥ (EW=0: ë™ì„œ, NS=1: ë‚¨ë¶)
    - Type: ì‹ í˜¸ë“± íƒ€ì… ('-': ë™ì„œë§Œ, '|': ë‚¨ë¶ë§Œ)
    - ew: ë™ì„œ ë°©í–¥ ì‹ í˜¸ ì§€ì† ì‹œê°„ (1~20)
    - ns: ë‚¨ë¶ ë°©í–¥ ì‹ í˜¸ ì§€ì† ì‹œê°„ (1~20)
    """
    if Type == '-':  # ë™ì„œ ë°©í–¥ë§Œ í†µê³¼ ê°€ëŠ¥í•œ ì‹ í˜¸ë“±
        r = t % (ew + ns)
        if d == EW and r >= ew:
            t += (ew + ns - r)
        if d == NS and r < ew:
            t += (ew - r)
    elif Type == '|':  # ë‚¨ë¶ ë°©í–¥ë§Œ í†µê³¼ ê°€ëŠ¥í•œ ì‹ í˜¸ë“±
        r = t % (ew + ns)
        if d == EW and r < ns:
            t += (ns - r)
        if d == NS and r >= ns:
            t += (ns + ew - r)
    return t + 1

def drive(Map, t_lights):
    """ë‹¤ìµìŠ¤íŠ¸ë¼ ì•Œê³ ë¦¬ì¦˜ì„ ì´ìš©í•œ ìµœë‹¨ ê²½ë¡œ íƒìƒ‰"""
    global m, n
    
    # ìµœë‹¨ ì‹œê°„ ì €ì¥ ë°°ì—´ ì´ˆê¸°í™”
    seen = [[float('inf') for _ in range(n)] for _ in range(m)]

    # ì‹œì‘ì  A ì°¾ê¸° - ë¬¸ì œ ì¡°ê±´ìƒ AëŠ” í•­ìƒ ì¡´ì¬
    ar, ac = 0, 0
    for i in range(m):
        for j in range(n):
            if Map[i][j] == 'A':
                ar, ac = i, j
                break
        if Map[i][j] == 'A':
            break

    # ìš°ì„ ìˆœìœ„ í ì´ˆê¸°í™” (ì‹œê°„, í–‰, ì—´)
    pq = [(0, ar, ac)]
    seen[ar][ac] = 0

    # ë‹¤ìµìŠ¤íŠ¸ë¼ ì•Œê³ ë¦¬ì¦˜ ì‹¤í–‰
    while pq:
        t, i, j = heapq.heappop(pq)

        # ëª©ì ì§€ Bì— ë„ë‹¬í•œ ê²½ìš°
        if Map[i][j] == 'B':
            return t

        # ì´ë¯¸ ë” ë¹ ë¥¸ ê²½ë¡œë¡œ ë°©ë¬¸í•œ ê²½ìš° ê±´ë„ˆë›°ê¸°
        if t > seen[i][j]:
            continue

        # ìƒí•˜ì¢Œìš° ë„¤ ë°©í–¥ íƒìƒ‰
        directions = [(0, -1, EW), (0, 1, EW), (-1, 0, NS), (1, 0, NS)]

        for di, dj, direction in directions:
            ni, nj = i + di, j + dj

            # ì§€ë„ ë²”ìœ„ ë‚´ì´ê³  ìœ íš¨í•œ ì…€ì¸ì§€ í™•ì¸
            if 0 <= ni < m and 0 <= nj < n and isValid(Map[ni][nj]):
                cell_type = Map[ni][nj]
                ew, ns = 0, 0  # ê¸°ë³¸ê°’ ì„¤ì •

                if cell_type.isdigit():
                    idx = int(cell_type)
                    # ë¬¸ì œ ì¡°ê±´ìƒ ì‹ í˜¸ë“± ì •ë³´ëŠ” í•­ìƒ ì¡´ì¬í•˜ì§€ë§Œ ì•ˆì „ì„ ìœ„í•´ ì²´í¬
                    if idx < len(t_lights) and t_lights[idx] is not None:
                        cell_type, ew, ns = t_lights[idx]

                # ë‹¤ìŒ ì‹œê°„ ê³„ì‚°
                next_time = entryTime(t, direction, cell_type, ew, ns)

                # ë” ë¹ ë¥¸ ê²½ë¡œë¥¼ ë°œê²¬í•œ ê²½ìš° ì—…ë°ì´íŠ¸
                if next_time < seen[ni][nj]:
                    seen[ni][nj] = next_time
                    heapq.heappush(pq, (next_time, ni, nj))

    # Bì— ë„ë‹¬í•  ìˆ˜ ì—†ëŠ” ê²½ìš°
    return -1

def main():
    """
    ë©”ì¸ í•¨ìˆ˜ - ë¬¸ì œ ì¡°ê±´ì´ ì™„ë²½í•˜ê²Œ ë³´ì¥ë˜ëŠ” ê°„ì†Œí™”ëœ ë²„ì „
    
    ğŸ¯ ê°€ì •:
    - ëª¨ë“  ì…ë ¥ì€ ì˜¬ë°”ë¥¸ í˜•ì‹
    - "0 0"ìœ¼ë¡œ ì •ìƒ ì¢…ë£Œ ë³´ì¥
    - ë¹ˆ ì¤„ë¡œ ì‹ í˜¸ë“± ì •ë³´ êµ¬ë¶„ ë³´ì¥
    - ëª¨ë“  ìˆ«ìëŠ” ì •ìˆ˜ í˜•íƒœ
    """
    global m, n

    while True:
        # ì§€ë„ í¬ê¸° ì…ë ¥ - ë¬¸ì œ ì¡°ê±´ìƒ í•­ìƒ ì˜¬ë°”ë¥¸ í˜•ì‹
        m, n = map(int, input().split())
        if m == 0 and n == 0:
            break

        # ì§€ë„ ì •ë³´ ì…ë ¥ - ë¬¸ì œ ì¡°ê±´ìƒ ì •í™•íˆ mì¤„
        Map = []
        for _ in range(m):
            Map.append(input().strip())

        # ì‹ í˜¸ë“± ì •ë³´ ì €ì¥ - ë™ì  ë¦¬ìŠ¤íŠ¸ ì‚¬ìš©
        t_lights = []

        # ì‹ í˜¸ë“± ì •ë³´ ì½ê¸° - ë¹ˆ ì¤„ê¹Œì§€ ì½ìŒ
        while True:
            line = input().strip()
            if not line:  # ë¹ˆ ì¤„ì´ë©´ ì‹ í˜¸ë“± ì…ë ¥ ì¢…ë£Œ
                break

            # ì‹ í˜¸ë“± ì •ë³´ íŒŒì‹± - ë¬¸ì œ ì¡°ê±´ìƒ í•­ìƒ ì˜¬ë°”ë¥¸ í˜•ì‹
            parts = line.split()
            index = int(parts[0])
            d = parts[1]
            ew = int(parts[2])
            ns = int(parts[3])

            # ë¦¬ìŠ¤íŠ¸ í¬ê¸°ë¥¼ ë™ì ìœ¼ë¡œ í™•ì¥
            while len(t_lights) <= index:
                t_lights.append(None)

            # ì˜¬ë°”ë¥¸ ì¸ë±ìŠ¤ì— ì €ì¥
            t_lights[index] = (d, ew, ns)

        # ìµœë‹¨ ê²½ë¡œ ê³„ì‚°
        time = drive(Map, t_lights)

        # ê²°ê³¼ ì¶œë ¥
        if time > 0:
            print(time)
        else:
            print('impossible')

if __name__ == '__main__':
    main()
```

---
